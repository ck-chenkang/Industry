# 当前刀具

[通过focas2获取刀具号](https://www.cncshare.com/21743.html/amp)

机床使用的时候，调用M06T3会，把更换好的刀具写入到宏变量#4120里面，只要读取这个值即可。

```c#
private void rdmacroinfo_Click(object sender, EventArgs e)
{
    ushort Flibhndl = 0;

    short ret;                 // 返回值

    // 获取库句柄 ( Ethernet )
    ret = Focas1.cnc_allclibhndl3("192.168.1.11", 8193, 10, out Flibhndl);
    if (ret != Focas1.EW_OK)
    {
        Console.WriteLine("发生异常，请检查！");
        return;
    }
    #region cnc_rdmacro

    short number = 4120; //这里修改成要读的位置
    short length = 100;
    Focas1.ODBM macro = new Focas1.ODBM();
    ret = Focas1.cnc_rdmacro(Flibhndl, number, length, macro);
    double data = macro.mcr_val * Math.Pow(10, -macro.dec_val);
    Console.WriteLine("用户宏变量" + macro.datano + "的值是" + data);
    #endregion
}
```

## 结果：

![image-20230215103630404](E:\codes\Industry\Fanuc CNC\Imag\image-20230215103630404.png)

![image-20230215103914955](E:\codes\Industry\Fanuc CNC\Imag\image-20230215103914955.png)