# 随系统启动

本文介绍了三种方法用于组态WinCC 开机自动运行，当电脑开机或重新启动时，WinCC 运行系统自动启动。

注：测试环境

操纵系统版本为：Windows 7

WinCC 版本为： 7.0 sp2 Asia

Simatic Net 版本为：8.0 sp1

其他版本的组态可能会稍有区别。

1 使用WinCC AutoStart工具进行组态

1．1 打开 WinCC AutoStart 工具

通过“Windows 开始菜单 〉All Programs > Siemens Automation > Simatic > WinCC > Autostart”打开 WinCC Autostart 工具(如果装置了其他的操纵系统，路径会有区别，如XP操纵系统路径为：“Windows 开始菜单 〉All Programs > Simatic > WinCC > Autostart”)；或者通过绝对路径“<SIEMENS Installation Path> SIEMENS > WinCC > bin > AutostartRT.exe”找到 AutostartRT.exe 打开 WinCC Autostart 工具。（如图1所示）

![img](https://wkrtcs.bdimg.com/rtcs/image?w=379&md5sum=95641e47f037ca14d44377ca4565f9cb&sign=f2ed39aa6e&rtcs_flag=1&rtcs_ver=4&l=webapp&bucketNum=786&ipr=%7B%22anchor%22%3A%7B%22dis_left%22%3A0%2C%22dis_right%22%3A0%7D%2C%22c%22%3A%22word%2Fmedia%2Fimage1.jpeg%22%2C%22dataType%22%3A%22jpeg%22%2C%22h%22%3A309%2C%22imgOriH%22%3A309%2C%22imgOriW%22%3A379%2C%22t%22%3A%22img%22%2C%22w%22%3A379%7D)图1 WinCC AutoStart 工具组态

1．2 WinCC AutoStart 组态

\1) 在项目中通过“…”选择需要开机自动运行的WinCC 项目；如果是冗余项目，则激活“添加另一个项目/冗余项目”并选择冗余项目。

\2) 选择“启动时激活项目”选项。

\3) 根据需求选择“激活时允许‘取消’”选项。

\4) 单击“激活自动启动”。

\5) 单击“确定”完成组态。

2 使用Simatic Net 组态

2.1 打开 Simatic Net Configuration Console

通过“Windows 开始菜单 〉All Programs > Siemens Automation > Simatic > Simatic Net > Configuration Console”打开 Configuration Console(如果装置了其他的操纵系统，路径会有区别，如XP操纵系统路径为：“Windows 开始菜单 〉All Programs > Simatic > Simatic Net > Configuration Console”)；或者通过绝对路径“<SIEMENS Installation Path> SIEMENS >SIMATIC.NET>opc2>bincfg>ibawiz.exe”找到ibawiz.exe打开Configuration Console。（如图2所示）

![img](https://wkrtcs.bdimg.com/rtcs/image?w=590&md5sum=95641e47f037ca14d44377ca4565f9cb&sign=f2ed39aa6e&rtcs_flag=1&rtcs_ver=4&l=webapp&bucketNum=786&ipr=%7B%22anchor%22%3A%7B%22dis_left%22%3A0%2C%22dis_right%22%3A0%7D%2C%22c%22%3A%22word%2Fmedia%2Fimage2.jpeg%22%2C%22dataType%22%3A%22jpeg%22%2C%22h%22%3A449%2C%22imgOriH%22%3A449%2C%22imgOriW%22%3A590%2C%22t%22%3A%22img%22%2C%22w%22%3A590%7D)图2 Configuration Console

2.2 组态Autostart 对话框

1） 打开Autostart 对话框： 在Configuration Console 中通过 "PC Station > SIMATIC NET Configuration > Applications > Autostart"选择 Autostart。

2） 选择“AutostartRT.exe”为自动启动应用程序：单击 "New" 按钮拔出一个新的应用程序。在弹出的对话框中选择"<SIEMENS Installation Path> SIEMENS > WinCC > bin > AutostartRT.exe"。

3） 为“AutostartRT.exe”分配参数：在 Arguments中添加如下参数：

<Drive>:\<Project path>\<Project name>.mcp /Active:yes /LANG=ENU /EnableBreak:no

4） 点击“Apply”来保管设置。

Arguments 参数说明：

<Drive>:\<Project path>\<Project name>.mcp参数指的是需要启动的WinCC项目的完整路径。

/Active 参数决定仅仅激活 WinCC 运行系统或者项目暂时打开然后立即关闭。

• /Active:yes

暗示只启动WinCC 运行系统。WinCC Explorer 不启动。

• /Active:no

暗示 WinCC运行系统在 WinCC Explorer 中启动后立即关闭。

此处参数一定要选择为/Active:yes ，否则无法启动 WinCC 运行系统。

/LANG 参数是指AutoStart的运行语言。

• /LANG=CHT

AutoStart运行语言为中文（中国）。

• /LANG=ENU

AutoStart运行语言为英语。

/EnableBreak 参数是指启动时是否激活取消按钮。

• /EnableBreak:no

启动时不激活取消按钮。

• /EnableBreak:yes

启动时激活取消按钮。

注意：需要在每个参数之间添加空格将参数分隔开。

3 使用Windows 启动菜单组态

3.1 组态WinCC 运行系统直接启动快捷方式

1） 发送AutostartRT.exe快捷方式：在WinCC 默认装置路径下“<SIEMENS Installation Path> SIEMENS > WinCC > bin > AutostartRT.exe”找到AutoStartRT.exe文件，右键此文件选择“发送到>桌面快捷方式”。

2） 定义AutostartRT.exe 快捷方式属性：右键建立好的桌面快捷方式，打开“属性”对话框，并切换到“快捷方式”标签页（如图3所示）。在“目标”之后添加空格和以下参数（不要删除引号内已有内容）：<Drive>:\<Project path>\<Project name>.mcp /Active:yes /LANG=ENU /EnableBreak:no

![img](https://wkrtcs.bdimg.com/rtcs/image?w=442&md5sum=95641e47f037ca14d44377ca4565f9cb&sign=f2ed39aa6e&rtcs_flag=1&rtcs_ver=4&l=webapp&bucketNum=786&ipr=%7B%22anchor%22%3A%7B%22dis_left%22%3A0%2C%22dis_right%22%3A0%7D%2C%22c%22%3A%22word%2Fmedia%2Fimage3.jpeg%22%2C%22dataType%22%3A%22jpeg%22%2C%22h%22%3A483%2C%22imgOriH%22%3A483%2C%22imgOriW%22%3A442%2C%22t%22%3A%22img%22%2C%22w%22%3A442%7D)图3 Autostart 快捷方式属性

3）单击“确定”保管设置。

注：

（1）参数说明请参考2.2节“Arguments 参数说明”部分。

（2）需要在每个参数之间添加空格将参数分隔开。这样AutoStart 快捷方式的属性中的Target的完整格式如下：

“<SIEMENS Installation Path>\SIEMENS\WinCC\bin\AutostartRT.exe” <Drive>:\<Project path>\<Project name>.mcp /Active:yes /LANG=ENU /EnableBreak:no

斜体部分请根据实际情况修改。

3.2 组态 Windows 启动菜单

将3.1步调中建立好的快捷方式拷贝到“C:\Users\Username\AppData\Roaming

\Microsoft\Windows\Start Menu\Programs\Startup”。 (如果装置了分歧语言版本的操纵系统，路径会有所分歧；如果装置了其他的操纵系统，路径也会有区别，如XP操纵系统路径为：“C:\Documents and Settings\Username\Start Menu\Programs\Startup”)。