# 错误处理

wincc错误处理，不能用try ... catch ... 

参考链接：

[wincc using error handling](https://stackoverflow.com/questions/157747/vbscript-using-error-handling)

## 参考结构

```vbscript
On Error Resume Next

DoStep1

If Err.Number <> 0 Then
  WScript.Echo "Error in DoStep1: " & Err.Description
  Err.Clear
End If

DoStep2

If Err.Number <> 0 Then
  WScript.Echo "Error in DoStop2:" & Err.Description
  Err.Clear
End If

'If you no longer want to continue following an error after that block's completed,
'call this.
On Error Goto 0
```



## 参考代码

```
Option Explicit
Function action

Dim Conn
Set Conn=Createobject("ADODB.Connection")

Dim Tag
Tag = HMIRuntime.Tags("HC_Feeding__set_T_temp").Read 

On Error Resume Next

Dim sCon

sCon="Provider=SQLOLEDB.1;Password=ck123456;Persist Security Info=True;User ID=sa;Initial Catalog=0205;;Data Source=103200192CC1\WINCC;"
Conn.ConnectionString = sCon
Conn.open

If Err.Number <> 0 Then
  MsgBox "Error in DoStep1: " & Err.Description
  Err.Clear
End If

Dim SqlInto
SqlInTo = "Insert Into Extruder1Cylinder (TUFeeding_ACT) Values ("& Tag &")"
Conn.Execute (SqlInTo)

If Err.Number <> 0 Then

  MsgBox "Error in DoStop2:" & Err.Description
  Err.Clear
End If

Conn.Close
Set Conn = Nothing
'If you no longer want to continue following an error after that block's completed,
'call this.
On Error Goto 0

End Function
```

